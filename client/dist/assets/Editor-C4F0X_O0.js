import{u as ee,r as c,j as e,b as me,a as he}from"./index-xMwKD10N.js";import{m as A,E as fe}from"./ElevationProfile-DP2kmXtP.js";import{a as xe,g as ge,b as pe,r as V}from"./index-DUWixUNR.js";function be({isOpen:o,lngLat:x,onSave:l,onClose:P,editingPoi:i}){const{t}=ee(),[f,L]=c.useState((i==null?void 0:i.name)||""),[S,R]=c.useState((i==null?void 0:i.description)||""),[M,F]=c.useState((i==null?void 0:i.type)||""),[d,k]=c.useState((i==null?void 0:i.amenities)||[]),[$,q]=c.useState((i==null?void 0:i.bestTime)||""),[v,z]=c.useState((i==null?void 0:i.images)||[]),b=c.useRef(null),D=[{value:"wc",labelKey:"toilet",icon:"fa-restroom",emoji:"ðŸš»"},{value:"food",labelKey:"food",icon:"fa-utensils",emoji:"ðŸ½ï¸"},{value:"charging",labelKey:"chargingStation",icon:"fa-charging-station",emoji:"âš¡"},{value:"difficulty",labelKey:"difficulty",icon:"fa-mountain",emoji:"ðŸ”ï¸"}],y=[{value:"hotel",labelKey:"hotel"},{value:"restaurant",labelKey:"restaurant"},{value:"gipfel",labelKey:"gipfel"},{value:"highlight",labelKey:"highlight"}],I=[{value:"morning",labelKey:"morning"},{value:"noon",labelKey:"noon"},{value:"afternoon",labelKey:"afternoon"},{value:"evening",labelKey:"evening"},{value:"allday",labelKey:"allday"}];if(!o)return null;const E=n=>{k(j=>j.includes(n)?j.filter(N=>N!==n):[...j,n])},T=n=>{const j=n.target.files;j&&Array.from(j).forEach(N=>{const g=new FileReader;g.onload=H=>{var K;(K=H.target)!=null&&K.result&&z(U=>[...U,H.target.result])},g.readAsDataURL(N)})},W=n=>{z(j=>j.filter((N,g)=>g!==n))},X=()=>{if(!f.trim()){alert(t("pleaseEnterName"));return}if(!M){alert(t("pleaseSelectPoiType"));return}l({name:f,description:S,type:M,amenities:d,bestTime:$,images:v,lngLat:x})};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[2000] p-4 overflow-y-auto",onClick:P,children:e.jsxs("div",{className:"bg-[#0b1215] border border-[#1e2a33] rounded-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-[#1e2a33]",children:[e.jsx("h2",{className:"text-[#088d95] text-lg font-semibold",children:t(i?"editPoi":"addPoi")}),e.jsx("button",{onClick:P,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-[#1e2a33] rounded-lg transition-all",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-400 text-sm mb-2",children:[t("poiName")," *"]}),e.jsx("input",{type:"text",value:f,onChange:n=>L(n.target.value),placeholder:t("poiNamePlaceholder"),className:"w-full px-4 py-2.5 bg-[#080e11] border border-[#1e2a33] rounded-lg text-white placeholder-gray-500 focus:border-[#088d95] focus:outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-2",children:t("poiImages")}),e.jsx("input",{type:"file",ref:b,multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:T,className:"hidden"}),e.jsxs("button",{onClick:()=>{var n;return(n=b.current)==null?void 0:n.click()},className:"w-full flex items-center justify-center gap-2 py-2.5 border border-dashed border-[#1e2a33] text-gray-400 hover:text-white hover:border-[#088d95] rounded-lg transition-all",children:[e.jsx("i",{className:"fas fa-upload"}),t("selectImages")]}),v.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:v.map((n,j)=>e.jsxs("div",{className:"relative w-20 h-20 rounded-lg overflow-hidden",children:[e.jsx("img",{src:n,alt:"",className:"w-full h-full object-cover"}),e.jsx("button",{onClick:()=>W(j),className:"absolute top-1 right-1 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-xs hover:bg-red-600",children:"Ã—"})]},j))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-2",children:t("amenitiesAndFeatures")}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:D.map(n=>e.jsxs("label",{className:`flex items-center gap-2 p-2.5 rounded-lg border cursor-pointer transition-all ${d.includes(n.value)?"bg-[#088d95]/20 border-[#088d95] text-white":"bg-[#080e11] border-[#1e2a33] text-gray-400 hover:border-[#088d95]/50"}`,children:[e.jsx("input",{type:"checkbox",checked:d.includes(n.value),onChange:()=>E(n.value),className:"sr-only"}),e.jsxs("span",{children:[n.emoji," ",t(n.labelKey)]})]},n.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-2",children:t("shortDescription")}),e.jsx("textarea",{value:S,onChange:n=>R(n.target.value),placeholder:t("shortDescriptionPlaceholder"),rows:3,className:"w-full px-4 py-2.5 bg-[#080e11] border border-[#1e2a33] rounded-lg text-white placeholder-gray-500 focus:border-[#088d95] focus:outline-none resize-none"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-400 text-sm mb-2",children:t("bestVisitTime")}),e.jsxs("select",{value:$,onChange:n=>q(n.target.value),className:"w-full px-4 py-2.5 bg-[#080e11] border border-[#1e2a33] rounded-lg text-white focus:border-[#088d95] focus:outline-none",children:[e.jsx("option",{value:"",children:t("pleaseSelect")}),I.map(n=>e.jsx("option",{value:n.value,children:t(n.labelKey)},n.value))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-gray-400 text-sm mb-2",children:[t("poiType")," *"]}),e.jsxs("select",{value:M,onChange:n=>F(n.target.value),className:"w-full px-4 py-2.5 bg-[#080e11] border border-[#1e2a33] rounded-lg text-white focus:border-[#088d95] focus:outline-none",children:[e.jsx("option",{value:"",children:t("pleaseSelect")}),y.map(n=>e.jsx("option",{value:n.value,children:t(n.labelKey)},n.value))]})]}),e.jsxs("div",{className:"p-3 bg-[#080e11] rounded-lg text-sm text-gray-500",children:[e.jsx("i",{className:"fas fa-map-marker-alt mr-2 text-[#088d95]"}),t("coordinates"),": ",x[0].toFixed(5),", ",x[1].toFixed(5)]})]}),e.jsxs("div",{className:"flex gap-3 p-6 border-t border-[#1e2a33]",children:[e.jsxs("button",{onClick:X,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-[#088d95] hover:bg-[#0da6ae] text-white rounded-lg font-medium transition-all",children:[e.jsx("i",{className:"fas fa-save"}),t("save")]}),e.jsxs("button",{onClick:P,className:"flex-1 flex items-center justify-center gap-2 py-3 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 rounded-lg font-medium transition-all",children:[e.jsx("i",{className:"fas fa-times"}),t("cancel")]})]})]})})}function ye(o){const l=new DOMParser().parseFromString(o,"text/xml");if(l.querySelector("parsererror"))throw new Error("Invalid GPX file format");let i=l.querySelectorAll("trkpt");if(i.length===0&&(i=l.querySelectorAll("rtept")),i.length===0&&(i=l.querySelectorAll("wpt")),i.length===0)throw new Error("No track or route points found in GPX file");return Array.from(i).map(f=>{var L;return{lat:parseFloat(f.getAttribute("lat")||"0"),lon:parseFloat(f.getAttribute("lon")||"0"),ele:parseFloat(((L=f.querySelector("ele"))==null?void 0:L.textContent)||"0")}})}function je(o,x){const P=(x.lat-o.lat)*Math.PI/180,i=(x.lon-o.lon)*Math.PI/180,t=Math.sin(P/2)*Math.sin(P/2)+Math.cos(o.lat*Math.PI/180)*Math.cos(x.lat*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371*2*Math.atan2(Math.sqrt(t),Math.sqrt(1-t))}function ve(o){if(o.length<2)throw new Error("GPX file must contain at least 2 points");let x=0;for(let d=0;d<o.length-1;d++)x+=je(o[d],o[d+1]);const l=70,P=5;let t=Math.ceil(x*2);t=Math.max(P,Math.min(t,l));const f=[];if(o.length>2){const d=Math.max(1,Math.floor((o.length-2)/t));for(let k=d;k<o.length-d&&f.length<t;k+=d)f.push([o[k].lon,o[k].lat])}const L=o.map(d=>[d.lon,d.lat]);let S=0,R=0,M=o[0].ele,F=o[0].ele;for(let d=1;d<o.length;d++){const k=o[d].ele-o[d-1].ele;k>0?S+=k:R+=Math.abs(k),o[d].ele>M&&(M=o[d].ele),o[d].ele<F&&(F=o[d].ele)}return{startPoint:[o[0].lon,o[0].lat],endPoint:[o[o.length-1].lon,o[o.length-1].lat],waypoints:f,routeGeometry:L,totalDistance:x,elevationGain:S,elevationLoss:R,highestPoint:M,lowestPoint:F}}function we(o){var i,t,f;const l=new DOMParser().parseFromString(o,"text/xml");return((i=l.querySelector("trk > name"))==null?void 0:i.textContent)||((t=l.querySelector("rte > name"))==null?void 0:t.textContent)||((f=l.querySelector("metadata > name"))==null?void 0:f.textContent)||null}A.accessToken="pk.eyJ1IjoicHVuY2hpbmdtYW4iLCJhIjoiY2p1cjcyMmh2M3NpZDQ5bnEwMDV6ZTE1OSJ9.ef8y6l9fsKFMX91m_Rt2ng";const _={hotel:{icon:"fa-hotel",color:"#3b82f6"},restaurant:{icon:"fa-utensils",color:"#f97316"},gipfel:{icon:"fa-mountain",color:"#22c55e"},highlight:{icon:"fa-star",color:"#eab308"}};function Le(){const{id:o}=me(),x=he(),{t:l}=ee(),P=!!o,i=c.useRef(null),t=c.useRef(null),f=c.useRef([]),L=c.useRef(null),[S,R]=c.useState(""),[M,F]=c.useState(""),[d,k]=c.useState(!1),[$,q]=c.useState(!1),[v,z]=c.useState(!1),[b,D]=c.useState(null),[y,I]=c.useState(null),[E,T]=c.useState([]),[W,X]=c.useState(null),[n,j]=c.useState([]),[N,g]=c.useState("start"),[H,K]=c.useState(!1),[U,te]=c.useState([0,0]),[p,B]=c.useState({distance:0,duration:0,highestPoint:0,lowestPoint:0,totalAscent:0,totalDescent:0}),[re]=c.useState(),[G,Z]=c.useState(null),O=c.useRef(null),ae={start:l("clickToSetStart"),waypoint:l("clickToAddWaypoint"),end:l("clickToSetEnd"),poi:l("clickToAddPoi")};c.useEffect(()=>{(async()=>{try{(await xe.getProfile()).success||x("/admin/login")}catch{x("/admin/login")}})()},[x]);const J=c.useRef(!0);c.useEffect(()=>{if(J.current=!0,!i.current){console.log("[Editor] No map container ref");return}if(t.current){console.log("[Editor] Map already exists");return}console.log("[Editor] Creating new map..."),console.log("[Editor] Container dimensions:",i.current.offsetWidth,"x",i.current.offsetHeight);try{t.current=new A.Map({container:i.current,style:"mapbox://styles/mapbox/outdoors-v12",center:[10.7865,51.8054],zoom:11}),t.current.addControl(new A.NavigationControl,"top-right"),t.current.on("load",()=>{console.log("[Editor] Map loaded"),J.current&&z(!0)}),t.current.on("error",r=>{console.error("[Editor] Map error:",r)})}catch(r){console.error("[Editor] Failed to create map:",r)}return()=>{console.log("[Editor] Cleanup called"),J.current=!1}},[]),c.useEffect(()=>{if(!t.current||!v)return;const r=s=>{const h=[s.lngLat.lng,s.lngLat.lat];N==="start"?(D(h),g("waypoint")):N==="end"?(I(h),g("waypoint")):N==="poi"?(te(h),K(!0)):b?T(y?a=>[...a,h]:a=>[...a,h]):D(h)};return t.current.on("click",r),()=>{var s;(s=t.current)==null||s.off("click",r)}},[v,N,b,y]),c.useEffect(()=>{if(!t.current||!v)return;const r=()=>{var h;if(!t.current||!t.current.isStyleLoaded()){(h=t.current)==null||h.once("style.load",r);return}if(f.current.forEach(a=>a.remove()),f.current=[],b){const a=document.createElement("div");a.innerHTML='<i class="fa-solid fa-play" style="color: white; font-size: 12px;"></i>',a.className="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center border-2 border-white cursor-move pl-0.5";const m=new A.Marker({element:a,draggable:!0}).setLngLat(b).addTo(t.current);m.on("dragend",()=>D([m.getLngLat().lng,m.getLngLat().lat])),f.current.push(m)}if(E.forEach((a,m)=>{const u=document.createElement("div");u.textContent=String(m+1),u.className="w-7 h-7 bg-[#088d95] rounded-full flex items-center justify-center border-2 border-white text-white text-xs font-bold cursor-move";const w=new A.Marker({element:u,draggable:!0}).setLngLat(a).addTo(t.current);w.on("dragend",()=>{T(C=>{const Y=[...C];return Y[m]=[w.getLngLat().lng,w.getLngLat().lat],Y})}),f.current.push(w)}),y){const a=document.createElement("div");a.innerHTML='<i class="fa-solid fa-flag-checkered" style="color: white; font-size: 12px;"></i>',a.className="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center border-2 border-white cursor-move";const m=new A.Marker({element:a,draggable:!0}).setLngLat(y).addTo(t.current);m.on("dragend",()=>I([m.getLngLat().lng,m.getLngLat().lat])),f.current.push(m)}n.forEach(a=>{const m=document.createElement("div"),u=_[a.type]||_.highlight;m.innerHTML=`
          <div style="position: relative;">
            <div style="position: absolute; width: 40px; height: 15px; bottom: -8px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.3); border-radius: 50%; filter: blur(5px);"></div>
            <div style="width: 40px; height: 40px; background: ${u.color}; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 3px solid white; box-shadow: 0 2px 8px rgba(0,0,0,0.3); position: relative; z-index: 2;">
              <i class="fas ${u.icon}" style="color: white; font-size: 16px;"></i>
            </div>
          </div>
        `,m.style.cursor="pointer";const w=new A.Marker({element:m,offset:[0,-24]}).setLngLat(a.lngLat).addTo(t.current);f.current.push(w)})},s=setTimeout(r,50);return()=>clearTimeout(s)},[b,E,y,n,v]),c.useEffect(()=>{if(!t.current||!v||!b||!y)return;const r=async()=>{var h;try{if(!t.current.isStyleLoaded()){t.current.once("style.load",()=>{r()});return}const a=await ge(b,E,y,"walking");if((h=a.routes)!=null&&h[0]){const m=a.routes[0],u=m.geometry.coordinates;X(u),console.log("[Editor] Route geometry saved:",u.length,"coordinates");const w=await pe(u);console.log("[Editor] Elevation data:",w),B(C=>({...C,distance:Number((m.distance/1e3).toFixed(2)),duration:Math.round(m.duration/60),highestPoint:w.highestPoint,lowestPoint:w.lowestPoint,totalAscent:w.totalAscent,totalDescent:w.totalDescent})),t.current.getLayer("route")&&t.current.removeLayer("route"),t.current.getSource("route")&&t.current.removeSource("route"),t.current.addSource("route",{type:"geojson",lineMetrics:!0,data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:m.geometry.coordinates}}}),t.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#088D95","line-width":4}})}}catch(a){console.error("Failed to calculate route:",a)}},s=setTimeout(r,100);return()=>clearTimeout(s)},[b,E,y,v]),c.useEffect(()=>{if(console.log("[Editor] Load route effect - id:",o,"mapLoaded:",v),!o||!v)return;(async()=>{var s,h;console.log("[Editor] Loading route data for id:",o),k(!0);try{const a=await V.getById(Number(o));console.log("[Editor] Route API result:",a),a.success&&(console.log("[Editor] Setting route data:",{startPoint:a.route.startPoint,endPoint:a.route.endPoint,waypoints:(s=a.route.waypoints)==null?void 0:s.length,pois:(h=a.route.pois)==null?void 0:h.length}),R(a.route.name),F(a.route.description||""),D(a.route.startPoint),I(a.route.endPoint),T(a.route.waypoints||[]),X(a.route.routeGeometry||null),j(a.route.pois||[]),B({distance:a.route.distance||0,duration:Math.round((a.route.duration||0)/60),highestPoint:a.route.highestPoint||0,lowestPoint:a.route.lowestPoint||0,totalAscent:a.route.totalAscent||0,totalDescent:a.route.totalDescent||0}),g("waypoint"))}catch(a){console.error("[Editor] Failed to load route:",a)}finally{k(!1)}})()},[o,v]),c.useEffect(()=>{if(!(!t.current||!v))if(G)if(O.current)O.current.setLngLat([G.lng,G.lat]);else{const r=document.createElement("div");r.className="w-4 h-4 bg-[#088d95] rounded-full border-2 border-white shadow-lg",O.current=new A.Marker({element:r}).setLngLat([G.lng,G.lat]).addTo(t.current)}else O.current&&(O.current.remove(),O.current=null)},[G,v]);const se=r=>{Z(r?{lng:r.lng,lat:r.lat}:null)},ne=r=>{t.current&&r.lngLat&&t.current.flyTo({center:r.lngLat,zoom:15,duration:1e3})},oe=async()=>{if(!S.trim()){alert("Route name is required");return}if(!b||!y){alert("Please set start and end points");return}q(!0);try{const r={name:S,description:M,startPoint:b,endPoint:y,routeGeometry:W,waypoints:E,pois:n.map(s=>({name:s.name,description:s.description,lngLat:s.lngLat,type:s.type,best_time:s.bestTime||s.best_time,images:s.images||[],amenities:s.amenities||[]})),distance:p.distance,duration:p.duration*60,highestPoint:p.highestPoint,lowestPoint:p.lowestPoint,totalAscent:p.totalAscent,totalDescent:p.totalDescent};P?await V.update(Number(o),r):await V.create(r),x("/admin")}catch(r){console.error("Failed to save route:",r),alert("Failed to save route")}finally{q(!1)}},Q=()=>{var r,s;D(null),I(null),T([]),j([]),B({distance:0,duration:0,highestPoint:0,lowestPoint:0,totalAscent:0,totalDescent:0}),g("start"),(r=t.current)!=null&&r.getLayer("route")&&t.current.removeLayer("route"),(s=t.current)!=null&&s.getSource("route")&&t.current.removeSource("route")},le=r=>T(s=>s.filter((h,a)=>a!==r)),ie=r=>j(s=>s.filter((h,a)=>a!==r)),ce=r=>{j(s=>[...s,{...r,id:Date.now()}]),K(!1),g("waypoint")},de=async r=>{var h;const s=(h=r.target.files)==null?void 0:h[0];if(s){try{const a=await s.text(),m=ye(a),u=ve(m),w=we(a);if(Q(),D(u.startPoint),I(u.endPoint),T(u.waypoints),X(u.routeGeometry),console.log("[Editor] GPX geometry saved:",u.routeGeometry.length,"coordinates"),w&&!S&&R(w),B(C=>({...C,distance:Number(u.totalDistance.toFixed(2)),highestPoint:Math.round(u.highestPoint),lowestPoint:Math.round(u.lowestPoint),totalAscent:Math.round(u.elevationGain),totalDescent:Math.round(u.elevationLoss)})),t.current){const C=new A.LngLatBounds;C.extend(u.startPoint),C.extend(u.endPoint),u.waypoints.forEach(Y=>C.extend(Y)),t.current.fitBounds(C,{padding:50})}g("waypoint")}catch(a){alert(`Error: ${a instanceof Error?a.message:"Unknown error"}`)}L.current&&(L.current.value="")}},ue=r=>{const s=Math.floor(r/60),h=r%60;return`${s}h ${h}m`};return e.jsxs("div",{className:"h-screen flex flex-col bg-[#0b1215] relative",children:[d&&e.jsx("div",{className:"absolute inset-0 z-[100] flex items-center justify-center bg-[#0b1215]/80",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("i",{className:"fas fa-spinner fa-spin text-3xl text-[#088d95]"}),e.jsx("span",{className:"text-gray-400",children:l("loading")})]})}),e.jsxs("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 z-50 px-5 py-2.5 bg-[#080e11] border border-[#1e2a33] rounded-lg text-white text-sm shadow-lg",children:[e.jsx("i",{className:"fas fa-info-circle text-[#088d95] mr-2"}),ae[N]]}),e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx("div",{className:"flex-1 relative min-h-[300px]",children:e.jsx("div",{ref:i,className:"absolute h-[100%]  inset-0 z-10"})}),e.jsx("div",{className:"h-[200px] bg-[#080e11] border-t border-[#1e2a33]",children:b&&y?e.jsx(fe,{route:{id:o?Number(o):0,name:S,description:M,startPoint:b,endPoint:y,waypoints:E,routeGeometry:W||void 0,distance:p.distance,duration:p.duration*60,highestPoint:p.highestPoint,lowestPoint:p.lowestPoint,totalAscent:p.totalAscent,totalDescent:p.totalDescent,pois:n.map((r,s)=>({poi_id:s,name:r.name||`POI ${s+1}`,lngLat:r.lngLat,type:r.type,images:r.images||[],amenities:r.amenities||[]}))},pois:n.map((r,s)=>({poi_id:s,name:r.name||`POI ${s+1}`,lngLat:r.lngLat,type:r.type,images:r.images||[],amenities:r.amenities||[]})),onPositionChange:se,highlightDistance:re,onPoiClick:r=>ne({lngLat:r.lngLat,name:r.name})}):e.jsx("div",{className:"h-full flex items-center justify-center text-gray-400",children:l("setStartEndHint")})})]}),e.jsxs("div",{className:"w-[300px] bg-[#080e11] border-l border-[#1e2a33] p-3 flex flex-col gap-3 overflow-y-auto",children:[e.jsx("input",{type:"text",value:S,onChange:r=>R(r.target.value),placeholder:l("routeNamePlaceholder"),className:"w-full px-3 py-2.5 bg-[#0b1215] border border-[#1e2a33] rounded-lg text-white placeholder-gray-500 focus:border-[#088d95] focus:outline-none"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{onClick:()=>g("start"),className:`flex items-center justify-center gap-2 py-2 rounded-lg text-sm transition-all ${N==="start"?"bg-green-500 text-white":"bg-[#0b1215] border border-[#1e2a33] text-gray-400 hover:border-green-500"}`,children:[e.jsx("i",{className:"fas fa-play"})," ",l("start")]}),e.jsxs("button",{onClick:()=>g("end"),className:`flex items-center justify-center gap-2 py-2 rounded-lg text-sm transition-all ${N==="end"?"bg-red-500 text-white":"bg-[#0b1215] border border-[#1e2a33] text-gray-400 hover:border-red-500"}`,children:[e.jsx("i",{className:"fas fa-flag-checkered"})," ",l("end")]}),e.jsxs("button",{onClick:()=>g("waypoint"),className:`flex items-center justify-center gap-2 py-2 rounded-lg text-sm transition-all ${N==="waypoint"?"bg-[#088d95] text-white":"bg-[#0b1215] border border-[#1e2a33] text-gray-400 hover:border-[#088d95]"}`,children:[e.jsx("i",{className:"fas fa-plus"})," ",l("waypoint")]}),e.jsxs("button",{onClick:()=>g("poi"),className:`flex items-center justify-center gap-2 py-2 rounded-lg text-sm transition-all ${N==="poi"?"bg-yellow-500 text-white":"bg-[#0b1215] border border-[#1e2a33] text-gray-400 hover:border-yellow-500"}`,children:[e.jsx("i",{className:"fas fa-map-marker-alt"})," POI"]})]}),e.jsxs("button",{onClick:oe,disabled:$,className:"w-full flex items-center justify-center gap-2 py-2.5 bg-[#088d95] hover:bg-[#0da6ae] text-white rounded-lg transition-all disabled:opacity-50",children:[$?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsx("i",{className:"fas fa-save"})," ",l("saveRoute")]}),e.jsxs("button",{onClick:Q,className:"w-full flex items-center justify-center gap-2 py-2.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 border border-red-500/30 rounded-lg transition-all",children:[e.jsx("i",{className:"fas fa-trash"})," ",l("deleteRoute")]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",ref:L,accept:".gpx",className:"hidden",onChange:de}),e.jsxs("button",{onClick:()=>{var r;return(r=L.current)==null?void 0:r.click()},className:"w-full flex items-center justify-center gap-2 py-2.5 border border-[#1e2a33] text-gray-400 hover:text-white hover:border-[#088d95] rounded-lg transition-all",children:[e.jsx("i",{className:"fas fa-upload"})," ",l("uploadGPX")]})]}),n.length>0&&e.jsxs("div",{className:"bg-[#0b1215] border border-[#1e2a33] rounded-lg p-3",children:[e.jsxs("h4",{className:"text-[#088d95] text-xs uppercase mb-2 font-semibold",children:["Interessenpunkte (",n.length,")"]}),e.jsx("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:n.map((r,s)=>e.jsxs("div",{className:"flex justify-between items-center py-1.5 px-2 bg-[#080e11] rounded border border-[#1e2a33]",children:[e.jsxs("span",{className:"text-sm text-white flex items-center gap-2 truncate",children:[e.jsx("i",{className:`fas ${(_[r.type]||_.highlight).icon}`,style:{color:(_[r.type]||_.highlight).color}}),r.name]}),e.jsx("button",{onClick:()=>ie(s),className:"text-red-400 hover:text-red-300 text-lg px-1",children:"Ã—"})]},s))})]}),e.jsxs("div",{className:"bg-[#0b1215] border border-[#1e2a33] rounded-lg p-3",children:[e.jsx("h4",{className:"text-[#088d95] text-xs uppercase mb-2 font-semibold",children:l("routePoints")}),b&&e.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-[#1e2a33]",children:[e.jsxs("span",{className:"text-sm text-white",children:[e.jsx("i",{className:"fas fa-play text-green-500 mr-2"}),l("start")]}),e.jsx("button",{onClick:()=>{D(null),g("start")},className:"text-red-400 hover:text-red-300 text-lg",children:"Ã—"})]}),E.map((r,s)=>e.jsxs("div",{className:"flex justify-between items-center py-1.5 border-b border-[#1e2a33]",children:[e.jsxs("span",{className:"text-sm text-white flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 bg-[#088d95] rounded-full flex items-center justify-center text-[11px] font-bold",children:s+1}),l("waypoint")," ",s+1]}),e.jsx("button",{onClick:()=>le(s),className:"text-red-400 hover:text-red-300 text-lg",children:"Ã—"})]},s)),y&&e.jsxs("div",{className:"flex justify-between items-center py-1.5",children:[e.jsxs("span",{className:"text-sm text-white",children:[e.jsx("i",{className:"fas fa-flag text-red-500 mr-2"}),l("end")]}),e.jsx("button",{onClick:()=>{I(null),g("end")},className:"text-red-400 hover:text-red-300 text-lg",children:"Ã—"})]}),!b&&!y&&E.length===0&&e.jsx("div",{className:"text-gray-500 text-sm py-2",children:l("clickOnMap")})]}),e.jsxs("div",{className:"bg-[#0b1215] border border-[#1e2a33] rounded-lg p-3",children:[e.jsx("h4",{className:"text-[#088d95] text-xs uppercase mb-2 font-semibold",children:l("routeStatistics")}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:l("distance")}),e.jsxs("span",{className:"text-[#088d95] font-semibold",children:[p.distance," km"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:l("duration")}),e.jsx("span",{className:"text-[#088d95] font-semibold",children:ue(p.duration)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:l("highestPoint")}),e.jsxs("span",{className:"text-[#088d95] font-semibold",children:[p.highestPoint," m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:l("lowestPoint")}),e.jsxs("span",{className:"text-[#088d95] font-semibold",children:[p.lowestPoint," m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:l("totalAscent")}),e.jsxs("span",{className:"text-green-500 font-semibold",children:["â†‘ ",p.totalAscent," m"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:l("totalDescent")}),e.jsxs("span",{className:"text-red-400 font-semibold",children:["â†“ ",p.totalDescent," m"]})]})]})]}),e.jsxs("button",{onClick:()=>x("/admin"),className:"mt-auto w-full flex items-center justify-center gap-2 py-2.5 border border-[#1e2a33] text-gray-400 hover:text-white hover:border-[#088d95] rounded-lg transition-all",children:[e.jsx("i",{className:"fas fa-arrow-left"})," ",l("back")]})]})]}),e.jsx(be,{isOpen:H,lngLat:U,onSave:ce,onClose:()=>{K(!1),g("waypoint")}})]})}export{Le as default};
