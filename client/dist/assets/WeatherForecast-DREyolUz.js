import{u as Y,r as l,j as e}from"./index-xMwKD10N.js";import{r as J,c as X,f as V}from"./index-DUWixUNR.js";import{m as E,R as U,P as q}from"./ElevationProfile-DP2kmXtP.js";function Q(t,i,o,r){const n=new Date().toISOString(),h=i.map(([g,a])=>`      <trkpt lat="${a}" lon="${g}"></trkpt>`).join(`
`);return`<?xml version="1.0" encoding="UTF-8"?>
<gpx version="1.1" creator="Harterbrocken Map" xmlns="http://www.topografix.com/GPX/1/1">
  <metadata>
    <name>${t} - ${r.toUpperCase()} Stage ${o}</name>
    <time>${n}</time>
  </metadata>
  <trk>
    <name>${t} - Stage ${o}</name>
    <type>${r}</type>
    <trkseg>
${h}
    </trkseg>
  </trk>
</gpx>`}function ee(t,i){const o=new Blob([t],{type:"application/gpx+xml"}),r=URL.createObjectURL(o),n=document.createElement("a");n.href=r,n.download=i,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(r)}function ge({routeId:t,onClose:i}){const{t:o}=Y(),[r,n]=l.useState(1),[h,g]=l.useState([]),[a,x]=l.useState(null),[N,v]=l.useState(null),[c,C]=l.useState([]),[_,$]=l.useState(!1),[F,y]=l.useState(!0),[p,W]=l.useState(null),[d,S]=l.useState(null);l.useEffect(()=>{(async()=>{try{const f=await J.getById(t);f.success&&W(f.route);const k=await X.getStartPoints(t);k.success&&k.data.length>0?(g(k.data),k.data.length===1&&(x(k.data[0].name),n(2))):n(2)}catch(f){console.error("Failed to load data:",f),n(2)}finally{y(!1)}})()},[t]);const m={gold:{stages:1,color:"#FFD700",labelKey:"goldLabel"},silver:{stages:2,color:"#C0C0C0",labelKey:"silverLabel"},bronze:{stages:3,color:"#CD7F32",labelKey:"bronzeLabel"}},A=s=>{x(s),n(2)},L=async s=>{v(s),$(!0);try{const f=await X.getByRoute(t,s,a||void 0);if(f.success&&f.data[s])C(f.data[s]);else{const k=m[s].stages;C(Array.from({length:k},(I,D)=>({stage_number:D+1,tour_type:s,id:null})))}}catch(f){console.error("Failed to load GPX files:",f);const k=m[s].stages;C(Array.from({length:k},(I,D)=>({stage_number:D+1,tour_type:s,id:null})))}finally{$(!1)}},T=async s=>{S(s.stage_number);try{if(s.id)X.download(s.id);else if(p){const f=p.routeGeometry&&p.routeGeometry.length>0?p.routeGeometry:[p.startPoint,...p.waypoints,p.endPoint],k=m[N].stages,I=Math.ceil(f.length/k),D=(s.stage_number-1)*I,M=s.stage_number===k?f.length:s.stage_number*I,P=f.slice(D,M);console.log(`[GPX] Downloading Stage ${s.stage_number}/${k}: points ${D}-${M} of ${f.length}`);const K=Q(p.name||`Route ${t}`,P,s.stage_number,s.tour_type),H=`${(p.name||"route").replace(/\s+/g,"_")}_${s.tour_type}_stage${s.stage_number}.gpx`;ee(K,H)}}catch(f){console.error("Download failed:",f),alert(o("downloadFailed"))}finally{S(null)}},j=()=>{r===2&&h.length>1&&(n(1),v(null),C([]))};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[1000] p-4",onClick:i,children:e.jsxs("div",{className:"bg-[#0b1215] border border-[#1e2a33] rounded-xl w-full max-w-md p-6",onClick:s=>s.stopPropagation(),children:[e.jsxs("h3",{className:"flex items-center gap-2 text-[#088d95] text-lg font-semibold mb-4",children:[e.jsx("i",{className:"fas fa-download"}),o("downloadGPX")]}),F&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-[#088d95]"})}),!F&&r===1&&h.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400 text-sm mb-5",children:o("selectStartPoint")}),e.jsx("div",{className:"space-y-3 mb-5",children:h.map(s=>e.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-lg cursor-pointer transition-all ${a===s.name?"border-[#088d95] bg-[#088d95]/10":"border-[#1e2a33] hover:border-[#088d95]/50"}`,onClick:()=>A(s.name),children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center bg-[#088d95] text-white",children:e.jsx("i",{className:"fas fa-map-marker-alt"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-white",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-400",children:[s.count," ",o("filesAvailable")]})]})]},s.name))})]}),!F&&r===2&&e.jsxs(e.Fragment,{children:[h.length>1&&e.jsxs("button",{onClick:j,className:"flex items-center gap-1 text-[#088d95] text-sm mb-3 hover:text-[#0da6ae] transition-all",children:[e.jsx("i",{className:"fas fa-arrow-left"}),a]}),e.jsx("p",{className:"text-gray-400 text-sm mb-5",children:o("selectTourType")}),e.jsx("div",{className:"space-y-3 mb-5",children:Object.keys(m).map(s=>e.jsxs("div",{className:`flex items-center gap-4 p-4 border rounded-lg cursor-pointer transition-all ${N===s?"border-[#088d95] bg-[#088d95]/10":"border-[#1e2a33] hover:border-[#088d95]/50"}`,onClick:()=>L(s),children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-black",style:{background:m[s].color},children:m[s].stages}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-white capitalize",children:o(s)}),e.jsx("div",{className:"text-sm text-gray-400",children:o(m[s].labelKey)})]})]},s))}),N&&!_&&e.jsxs("div",{className:"bg-[#080e11] rounded-lg p-4 mb-5",children:[e.jsxs("div",{className:"text-[#088d95] font-semibold mb-3",children:[o("stages"),":"]}),e.jsx("div",{className:"space-y-2",children:c.map((s,f)=>e.jsxs("div",{className:"flex items-center justify-between py-2 border-b border-[#1e2a33] last:border-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white",children:[e.jsx("i",{className:"fas fa-file text-[#088d95]"}),o("stage")," ",s.stage_number,s.id&&e.jsx("span",{className:"text-xs text-green-500 ml-1",children:e.jsx("i",{className:"fas fa-check-circle"})})]}),e.jsx("button",{onClick:()=>T(s),disabled:d===s.stage_number,className:"px-3 py-1.5 bg-[#088d95] hover:bg-[#0da6ae] text-white text-sm rounded-lg transition-all disabled:opacity-50",children:d===s.stage_number?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsx("i",{className:"fas fa-download"})})]},f))})]}),_&&e.jsx("div",{className:"text-center py-8 text-gray-400",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-[#088d95]"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-4 py-2 border border-[#1e2a33] text-gray-400 hover:text-white hover:border-[#088d95] rounded-lg transition-all",children:[e.jsx("i",{className:"fas fa-times"}),o("cancel")]})})]})})}E.accessToken="pk.eyJ1IjoicHVuY2hpbmdtYW4iLCJhIjoiY2p1cjcyMmh2M3NpZDQ5bnEwMDV6ZTE1OSJ9.ef8y6l9fsKFMX91m_Rt2ng";const te={gold:["#FFD700"],silver:["#C0C0C0","#8A8A8A"],bronze:["#CD7F32","#B87333","#A0522D"]},ae={gold:{stages:1},silver:{stages:2},bronze:{stages:3}};function B(t,i,o,r){const h=(o-t)*Math.PI/180,g=(r-i)*Math.PI/180,a=Math.sin(h/2)*Math.sin(h/2)+Math.cos(t*Math.PI/180)*Math.cos(o*Math.PI/180)*Math.sin(g/2)*Math.sin(g/2);return 6371e3*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}function se(t,i){const o=t[0]*Math.PI/180,r=t[1]*Math.PI/180,n=i[0]*Math.PI/180,g=i[1]*Math.PI/180-r,a=Math.sin(g)*Math.cos(n),x=Math.cos(o)*Math.sin(n)-Math.sin(o)*Math.cos(n)*Math.cos(g);return(Math.atan2(a,x)*180/Math.PI+360)%360}function fe({route:t,tourType:i="gold",onPositionChange:o,onPoiClick:r,isFullscreen:n=!1,highlightPosition:h}){const g=l.useRef(null),a=l.useRef(null),x=l.useRef([]),N=l.useRef([]),v=l.useRef(null),c=l.useRef(null),C=l.useRef([]),[_,$]=l.useState(!1),F=l.useCallback((d,S)=>{const m=[S.startPoint,...S.waypoints,S.endPoint];let A=1/0,L=0;for(let j=0;j<m.length-1;j++){const s=B(d[1],d[0],m[j][1],m[j][0]);s<A&&(A=s,L=j)}let T=0;for(let j=0;j<L;j++)T+=B(m[j][1],m[j][0],m[j+1][1],m[j+1][0]);return{distance:T/1e3,index:L}},[]),y=l.useCallback(()=>{if(!a.current||a.current.hasImage("route-arrow"))return;const d=new Image(24,24);d.onload=()=>{a.current&&!a.current.hasImage("route-arrow")&&a.current.addImage("route-arrow",d,{sdf:!0})},d.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
      <svg id="route-arrow" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28">
        <polygon points="14 1 1 27 14 22 27 27 14 1" fill="#fff" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/>
      </svg>
    `)},[]),p=l.useCallback(d=>{if(!a.current)return;const S=a.current.getZoom(),A=800*Math.pow(2.2,14-S),L=Math.max(Math.min(A,5e3),150),T=Math.max(30,100-S*5),j=[];let s=0,f=null;for(let I=1;I<d.length-1;I++){const D=d[I-1],M=d[I],P=d[I+1],K=B(D[1],D[0],M[1],M[0]);if(s+=K,s>=L){const H=se([M[1],M[0]],[P[1],P[0]]);B(M[1],M[0],P[1],P[0])>T&&(!f||B(f[1],f[0],M[1],M[0])>L/2)&&(j.push({type:"Feature",geometry:{type:"Point",coordinates:M},properties:{bearing:H}}),s=0,f=M)}}a.current.getLayer("routeArrows")&&a.current.removeLayer("routeArrows"),a.current.getSource("arrow-source")&&a.current.removeSource("arrow-source"),a.current.addSource("arrow-source",{type:"geojson",data:{type:"FeatureCollection",features:j}});const k=Math.max(.12,Math.min(.3,.12+(S-8)*.02));a.current.addLayer({id:"routeArrows",type:"symbol",source:"arrow-source",layout:{"icon-image":"route-arrow","icon-size":k,"icon-allow-overlap":!0,"icon-ignore-placement":!0,"icon-rotate":["get","bearing"],"icon-rotation-alignment":"map","icon-offset":[0,0]},paint:{"icon-opacity":1,"icon-color":"#FFFFFF"}})},[]);l.useEffect(()=>{if(!(!g.current||a.current))return a.current=new E.Map({container:g.current,style:"mapbox://styles/mapbox/outdoors-v12",center:[10.57,51.92],zoom:10,pitch:45,bearing:20,attributionControl:!1}),a.current.addControl(new E.NavigationControl,"top-right"),a.current.addControl(new E.ScaleControl,"bottom-left"),a.current.on("load",()=>{y(),$(!0)}),()=>{var d;(d=a.current)==null||d.remove(),a.current=null}},[y]);const W=l.useCallback((d,S)=>{const m=[],A=Math.ceil(d.length/S);for(let L=0;L<S;L++){const T=L*A,j=Math.min((L+1)*A+1,d.length);m.push(d.slice(T,j))}return m},[]);return l.useEffect(()=>{if(!a.current||!_||!t)return;const d=ae[i];x.current.forEach(u=>u.remove()),x.current=[],N.current.forEach(u=>u.remove()),N.current=[],(a.current.getStyle().layers||[]).forEach(u=>{(u.id.startsWith("route-stage-")||u.id.startsWith("route-outline-stage-")||u.id==="route-hover"||u.id==="routeArrows")&&a.current.removeLayer(u.id)});for(let u=0;u<3;u++)a.current.getSource(`route-stage-${u}`)&&a.current.removeSource(`route-stage-${u}`);a.current.getSource("route-hover-source")&&a.current.removeSource("route-hover-source"),a.current.getSource("arrow-source")&&a.current.removeSource("arrow-source");let m;t.routeGeometry&&t.routeGeometry.length>0?(m=t.routeGeometry,console.log("[Map] Using stored routeGeometry:",m.length,"points")):(m=[t.startPoint,...t.waypoints,t.endPoint],console.log("[Map] No routeGeometry, using waypoints:",m.length,"points")),C.current=m,W(m,d.stages).forEach((u,w)=>{const b=`route-stage-${w}`,z=`route-outline-stage-${w}`,R=`route-stage-${w}`;a.current.addSource(b,{type:"geojson",lineMetrics:!0,data:{type:"Feature",properties:{stage:w+1},geometry:{type:"LineString",coordinates:u}}}),a.current.addLayer({id:z,type:"line",source:b,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":U.MAIN.OUTLINE_COLOR,"line-width":U.MAIN.WIDTH+U.MAIN.OUTLINE_WIDTH*2}}),a.current.addLayer({id:R,type:"line",source:b,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":U.MAIN.COLOR,"line-width":U.MAIN.WIDTH}})}),a.current.addSource("route-hover-source",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:m}}}),a.current.addLayer({id:"route-hover",type:"line",source:"route-hover-source",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"transparent","line-width":20}}),a.current.hasImage("route-arrow")&&p(m);const L=u=>{if(!t||!o)return;const w=[u.lngLat.lng,u.lngLat.lat],{distance:b,index:z}=F(w,t);if(v.current)v.current.setLngLat(w);else{const R=document.createElement("div");R.className="hover-marker",R.style.cssText=`
          width: 20px; height: 20px; 
          background-color: #0b1215;
          border-radius: 50%;
          border: 2px solid white;
          box-shadow: 0 0 5px rgba(46, 46, 46, 0.5);
          pointer-events: none;
        `,v.current=new E.Marker({element:R}).setLngLat(w).addTo(a.current)}a.current.getCanvas().style.cursor="pointer",o({lng:w[0],lat:w[1],distance:b,index:z})},T=()=>{v.current&&(v.current.remove(),v.current=null),a.current.getCanvas().style.cursor=""};a.current.on("mousemove","route-hover",L),a.current.on("mouseleave","route-hover",T);const j=()=>{var u;C.current.length>0&&((u=a.current)!=null&&u.hasImage("route-arrow"))&&p(C.current)};a.current.on("zoomend",j);const s=te[i];if(d.stages>1){const u=Math.ceil(m.length/d.stages);for(let w=1;w<d.stages;w++){const b=Math.min(w*u,m.length-1),z=m[b],R=s[(w-1)%s.length],G=document.createElement("div");G.className="stage-marker",G.innerHTML=`
          <div style="
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
          ">
            <div class="stage-tooltip" style="
              position: absolute;
              bottom: 100%;
              left: 50%;
              transform: translateX(-50%) translateY(-4px);
              background: ${R};
              color: ${i==="gold"?"#000":"#fff"};
              font-weight: bold;
              font-size: 11px;
              padding: 4px 10px;
              border-radius: 6px;
              border: 2px solid white;
              box-shadow: 0 2px 8px rgba(0,0,0,0.4);
              white-space: nowrap;
              opacity: 0;
              pointer-events: none;
              transition: opacity 0.2s ease, transform 0.2s ease;
            ">
              Stage ${w} ‚Üí ${w+1}
            </div>
            <div class="stage-dot" style="
              width: 20px;
              height: 20px;
              background: ${R};
              border-radius: 50%;
              border: 3px solid white;
              box-shadow: 0 2px 8px rgba(0,0,0,0.4);
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 10px;
              font-weight: bold;
              color: ${i==="gold"?"#000":"#fff"};
            ">${w}</div>
          </div>
        `,G.addEventListener("mouseenter",()=>{const O=G.querySelector(".stage-tooltip");O&&(O.style.opacity="1",O.style.transform="translateX(-50%) translateY(-8px)")}),G.addEventListener("mouseleave",()=>{const O=G.querySelector(".stage-tooltip");O&&(O.style.opacity="0",O.style.transform="translateX(-50%) translateY(-4px)")});const Z=new E.Marker({element:G,anchor:"bottom"}).setLngLat(z).addTo(a.current);N.current.push(Z)}}const f=document.createElement("div");f.className="marker start-marker",f.innerHTML=`
      <div style="
        background: #0b1215;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #e0e0e0;
        box-shadow: 0 2px 8px rgba(8, 141, 149, 0.2);
        cursor: pointer;
        padding-left: 2px;
      ">
        <i class="fa-solid fa-play" style="font-size: 14px; color: #fff;"></i>
      </div>
    `;const k=new E.Marker({element:f}).setLngLat(t.startPoint).addTo(a.current);x.current.push(k);const I=document.createElement("div");I.className="marker end-marker",I.innerHTML=`
      <div style="
        background: #0b1215;
        width: 36px;
        height: 36px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        border: 2px solid #e0e0e0;
        box-shadow: 0 2px 8px rgba(8, 141, 149, 0.2);
        cursor: pointer;
      ">
        <i class="fa-solid fa-flag-checkered" style="font-size: 14px; color: #fff;"></i>
      </div>
    `;const D=new E.Marker({element:I}).setLngLat(t.endPoint).addTo(a.current);x.current.push(D),t.pois&&t.pois.length>0&&t.pois.forEach(u=>{const w=q[u.type||"highlight"]||q.highlight,b=document.createElement("div"),z=36;b.className="poi-marker",b.style.width=`${z}px`,b.style.height=`${z}px`,b.style.backgroundColor=w.bg,b.style.border="3px solid white",b.style.borderRadius="50%",b.style.display="flex",b.style.alignItems="center",b.style.justifyContent="center",b.style.boxShadow="0 2px 8px rgba(0,0,0,0.3)",b.style.cursor="pointer",b.style.padding="0",b.tabIndex=0;const R=document.createElement("i");R.className=`fas ${w.icon}`,R.style.color="white",R.style.fontSize="14px",R.style.pointerEvents="none",b.appendChild(R),b.addEventListener("click",()=>{r==null||r(u)}),new E.Marker(b).setLngLat(u.lngLat).addTo(a.current)});const M=[...m];t.pois&&t.pois.forEach(u=>M.push(u.lngLat));const P=M.reduce((u,w)=>u.extend(w),new E.LngLatBounds(M[0],M[0])),H=window.innerWidth<768?{top:50,bottom:50,left:20,right:20}:{top:50,bottom:50,left:50,right:50};return a.current.fitBounds(P,{padding:H,maxZoom:15,pitch:45,bearing:20,duration:1500}),()=>{a.current&&(a.current.off("mousemove","route-hover",L),a.current.off("mouseleave","route-hover",T),a.current.off("zoomend",j))}},[t,i,_,r,o,F,W,p]),l.useEffect(()=>{if(!(!a.current||!_))if(h)if(c.current)c.current.setLngLat([h.lng,h.lat]);else{const d=document.createElement("div");d.className="highlight-marker",d.style.cssText=`
          width: 16px; height: 16px;
          background-color: #088D95;
          border-radius: 50%;
          border: 3px solid white;
          box-shadow: 0 0 8px rgba(8, 141, 149, 0.6);
          pointer-events: none;
        `,c.current=new E.Marker({element:d}).setLngLat([h.lng,h.lat]).addTo(a.current)}else c.current&&(c.current.remove(),c.current=null)},[h,_]),l.useEffect(()=>()=>{var d,S;(d=v.current)==null||d.remove(),(S=c.current)==null||S.remove()},[]),e.jsx("div",{ref:g,className:`w-full ${n?"h-screen fixed inset-0 z-[999]":"h-full min-h-[100%] relative"}`})}function re(t,i){const[r,n]=t,[h,g]=i,a=(g-n)*Math.PI/180,x=(h-r)*Math.PI/180,N=Math.sin(a/2)*Math.sin(a/2)+Math.cos(n*Math.PI/180)*Math.cos(g*Math.PI/180)*Math.sin(x/2)*Math.sin(x/2);return 6371*(2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N)))}function xe({poi:t,routeStartPoint:i,onClose:o}){const{t:r}=Y(),[n,h]=l.useState(0),[g,a]=l.useState("overview");if(!t)return null;const x=t.images&&t.images.length>0,N=t.images&&t.images.length>1,v=()=>{t.images&&h(y=>(y+1)%t.images.length)},c=()=>{t.images&&h(y=>(y-1+t.images.length)%t.images.length)},C=y=>{h(y)},_=y=>r({morning:"morning",noon:"noon",afternoon:"afternoon",evening:"evening",allday:"allday"}[y]||y),$=y=>({food:"fa-utensils",wc:"fa-restroom",charging:"fa-charging-station",difficulty:"fa-mountain",parking:"fa-parking",water:"fa-droplet",shelter:"fa-house",viewpoint:"fa-binoculars",camping:"fa-campground",wifi:"fa-wifi",shower:"fa-shower"})[y.toLowerCase()]||"fa-circle",F=y=>r({food:"food",wc:"toilet",charging:"chargingStation",difficulty:"difficulty",parking:"parking",water:"waterSource",shelter:"shelter",viewpoint:"viewpoint",camping:"camping",wifi:"wifi",shower:"shower"}[y.toLowerCase()]||y);return e.jsx("div",{className:`poi-sidebar ${t?"visible":""}`,children:e.jsxs("div",{className:"poi-content",children:[e.jsxs("div",{className:"poi-hero",children:[e.jsx("button",{className:"close-button",onClick:o,children:e.jsx("i",{className:"fas fa-times"})}),e.jsxs("div",{className:"image-carousel",children:[e.jsx("div",{className:"carousel-container",children:x?t.images.map((y,p)=>e.jsx("img",{src:y,alt:t.name,className:"carousel-image",style:{display:p===n?"block":"none"},"data-index":p,onError:W=>{W.currentTarget.src="/api/placeholder/400/320"}},p)):e.jsx("div",{className:"carousel-placeholder",children:e.jsx("i",{className:"fas fa-mountain"})})}),N&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"carousel-button prev",onClick:c,children:"‚ùÆ"}),e.jsx("button",{className:"carousel-button next",onClick:v,children:"‚ùØ"}),e.jsx("div",{className:"carousel-dots",children:t.images.map((y,p)=>e.jsx("span",{className:`dot ${p===n?"active":""}`,onClick:()=>C(p)},p))})]})]}),e.jsx("div",{className:"poi-hero-overlay",children:e.jsx("h1",{className:"poi-hero-title",children:t.name})})]}),e.jsxs("div",{className:"poi-category-nav",children:[e.jsxs("div",{className:"category-buttons",children:[e.jsxs("button",{className:`category-btn ${g==="overview"?"active":""}`,"data-category":"overview",onClick:()=>a("overview"),children:[e.jsx("i",{className:"fas fa-info-circle"}),e.jsx("span",{children:r("overview")})]}),e.jsxs("button",{className:`category-btn ${g==="facilities"?"active":""}`,"data-category":"facilities",onClick:()=>a("facilities"),children:[e.jsx("i",{className:"fas fa-wrench"}),e.jsx("span",{children:r("facilitiesAndService")})]}),e.jsxs("button",{className:`category-btn ${g==="location"?"active":""}`,"data-category":"location",onClick:()=>a("location"),children:[e.jsx("i",{className:"fas fa-map-pin"}),e.jsx("span",{children:r("location")})]})]}),e.jsxs("div",{className:"category-content",children:[e.jsxs("div",{className:`category-panel ${g==="overview"?"active":""}`,id:"overview-panel",children:[e.jsx("p",{className:"poi-description",children:t.description||r("noDescriptionAvailable")}),t.best_time&&e.jsx("div",{className:"poi-additional-info",children:e.jsxs("div",{className:"poi-info-item",children:[e.jsx("i",{className:"fas fa-clock"}),e.jsxs("span",{children:[r("bestVisitTime"),": ",_(t.best_time)]})]})})]}),e.jsx("div",{className:`category-panel ${g==="facilities"?"active":""}`,id:"facilities-panel",children:t.amenities&&t.amenities.length>0?e.jsx("div",{className:"poi-amenities-grid",children:t.amenities.map((y,p)=>e.jsxs("div",{className:"poi-amenity-item",children:[e.jsx("i",{className:`fas ${$(y)}`}),e.jsx("span",{children:F(y)})]},p))}):e.jsx("p",{className:"no-facilities",children:r("noFacilitiesAvailable")})}),e.jsxs("div",{className:`category-panel ${g==="location"?"active":""}`,id:"location-panel",children:[e.jsxs("div",{className:"location-coordinates",children:[e.jsx("i",{className:"fas fa-map-marker-alt"}),e.jsxs("span",{children:[r("coordinates"),": ",t.lngLat[0].toFixed(2),","," ",t.lngLat[1].toFixed(2)]})]}),e.jsx("div",{className:"route-distance-info",children:e.jsxs("p",{children:[e.jsx("i",{className:"fas fa-route"}),r("distanceToRoute"),":"," ",i?re(i,t.lngLat).toFixed(1):"0.0"," ","km"]})})]})]})]})]})})}function ne({lat:t,lng:i,compact:o=!1}){const{i18n:r}=Y(),[n,h]=l.useState(null),[g,a]=l.useState(!0);return l.useEffect(()=>{const x=async()=>{try{const c=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${t}&longitude=${i}&current=temperature_2m,relative_humidity_2m,weather_code,wind_speed_10m`)).json();if(c.current){const C=oe(c.current.weather_code);h({temperature:Math.round(c.current.temperature_2m),condition:ie(c.current.weather_code,r.language),conditionKey:C,icon:ce(c.current.weather_code),humidity:c.current.relative_humidity_2m,wind:Math.round(c.current.wind_speed_10m)})}}catch(v){console.error("Failed to fetch weather:",v)}finally{a(!1)}};x();const N=setInterval(x,1800*1e3);return()=>clearInterval(N)},[t,i,r.language]),g?e.jsx("div",{className:`flex items-center justify-center ${o?"p-2":"p-4"} bg-[#080e11] border border-[#1e2a33] rounded-lg text-gray-400`,children:e.jsx("i",{className:"fas fa-spinner fa-spin text-[#088d95]"})}):n?o?e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#080e11] border border-[#1e2a33] rounded-lg",children:[e.jsx("i",{className:`fas fa-${n.icon} text-[#088d95]`}),e.jsxs("span",{className:"text-white font-semibold",children:[n.temperature,"¬∞C"]}),e.jsx("span",{className:"text-gray-400 text-sm hidden sm:inline",children:n.condition})]}):e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 bg-[#080e11] border border-[#1e2a33] rounded-lg",children:[e.jsx("div",{className:"text-2xl text-[#088d95]",children:e.jsx("i",{className:`fas fa-${n.icon}`})}),e.jsxs("div",{className:"text-2xl font-semibold text-white",children:[n.temperature,"¬∞C"]}),e.jsxs("div",{className:"flex flex-col gap-0.5",children:[e.jsx("div",{className:"text-sm text-gray-400",children:n.condition}),e.jsxs("div",{className:"flex gap-3 text-xs text-gray-500",children:[e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-droplet text-[#088d95] mr-1"}),n.humidity,"%"]}),e.jsxs("span",{children:[e.jsx("i",{className:"fas fa-wind text-[#088d95] mr-1"}),n.wind," km/h"]})]})]})]}):null}function oe(t){return{0:"weatherClear",1:"weatherMostlyClear",2:"weatherPartlyCloudy",3:"weatherCloudy",45:"weatherFog",48:"weatherFogRime",51:"weatherLightDrizzle",53:"weatherModerateDrizzle",55:"weatherHeavyDrizzle",61:"weatherLightRain",63:"weatherModerateRain",65:"weatherHeavyRain",71:"weatherLightSnow",73:"weatherModerateSnow",75:"weatherHeavySnow",80:"weatherRainShowers",81:"weatherModerateRainShowers",82:"weatherHeavyRainShowers",95:"weatherThunderstorm",96:"weatherThunderstormHail"}[t]||"weatherUnknown"}function ie(t,i){const o={de:{0:"Klar",1:"√úberwiegend klar",2:"Teilweise bew√∂lkt",3:"Bew√∂lkt",45:"Nebel",48:"Nebel mit Reif",51:"Leichter Niesel",53:"M√§√üiger Niesel",55:"Starker Niesel",61:"Leichter Regen",63:"M√§√üiger Regen",65:"Starker Regen",71:"Leichter Schnee",73:"M√§√üiger Schnee",75:"Starker Schnee",80:"Regenschauer",81:"M√§√üige Regenschauer",82:"Starke Regenschauer",95:"Gewitter",96:"Gewitter mit Hagel"},en:{0:"Clear",1:"Mostly Clear",2:"Partly Cloudy",3:"Cloudy",45:"Fog",48:"Rime Fog",51:"Light Drizzle",53:"Moderate Drizzle",55:"Heavy Drizzle",61:"Light Rain",63:"Moderate Rain",65:"Heavy Rain",71:"Light Snow",73:"Moderate Snow",75:"Heavy Snow",80:"Rain Showers",81:"Moderate Rain Showers",82:"Heavy Rain Showers",95:"Thunderstorm",96:"Thunderstorm with Hail"}};return(o[i]||o.de)[t]||(i==="en"?"Unknown":"Unbekannt")}function ce(t){return t===0?"sun":t<=3?"cloud-sun":t<=48?"smog":t<=55?"cloud-rain":t<=65?"cloud-showers-heavy":t<=75?"snowflake":t<=82?"cloud-rain":"cloud-bolt"}function pe({route:t,tourType:i,onTourTypeChange:o,showWeather:r=!0,showTourSelector:n=!0,showDownloadButton:h=!1,onDownloadClick:g}){var v;const{t:a}=Y(),x=(t.startPoint[1]+t.endPoint[1])/2,N=(t.startPoint[0]+t.endPoint[0])/2;return e.jsxs("div",{className:"route-stats-bar",id:"route-stats-bar",children:[e.jsxs("div",{className:"stats-left",children:[e.jsx("h1",{className:"route-title",id:"routeTitle",children:t.name}),n&&e.jsx("div",{className:"tour-type-selector",children:["gold","silver","bronze"].map(c=>e.jsx("button",{onClick:()=>o(c),className:`tour-type-btn ${i===c?"active":""}`,"data-type":c,children:a(c)},c))})]}),e.jsxs("div",{className:"stats-center",children:[e.jsxs("div",{className:"stat-item",title:a("distance"),children:[e.jsx("i",{className:"fas fa-route"}),e.jsxs("span",{children:[(v=t.distance)==null?void 0:v.toFixed(1)," km"]})]}),e.jsxs("div",{className:"stat-item",title:a("duration"),children:[e.jsx("i",{className:"fas fa-clock"}),e.jsx("span",{children:V(t.duration||0)})]}),e.jsxs("div",{className:"stat-item",title:a("totalAscent"),children:[e.jsx("i",{className:"fas fa-arrow-up"}),e.jsxs("span",{children:[Math.round(t.totalAscent||0)," m"]})]}),e.jsxs("div",{className:"stat-item",title:a("lowestPoint"),children:[e.jsx("i",{className:"fas fa-arrow-down"}),e.jsxs("span",{children:[Math.round(t.lowestPoint||0)," m"]})]}),e.jsxs("div",{className:"stat-item",title:a("highestPoint"),children:[e.jsx("i",{className:"fas fa-mountain"}),e.jsxs("span",{children:[Math.round(t.highestPoint||0)," m"]})]})]}),e.jsxs("div",{className:"stats-right",children:[r&&e.jsx("div",{className:"weather-container",children:e.jsx(ne,{lat:x,lng:N,compact:!0})}),h&&g&&e.jsxs("button",{className:"download-btn",onClick:g,children:[e.jsx("i",{className:"fas fa-download"}),e.jsx("span",{className:"download-text",children:a("downloadGPX")})]}),e.jsx("a",{href:"https://mountainsquad.com/",target:"_blank",rel:"noopener noreferrer",className:"logo-link",children:e.jsx("img",{src:"/images/small-logo.png",alt:"Mountain Squad",className:"ms-logo",onError:c=>{c.currentTarget.style.display="none"}})})]})]})}function ye({lat:t,lng:i,locationName:o="Wernigerode"}){const{i18n:r}=Y(),[n,h]=l.useState([]),[g,a]=l.useState(!0);return l.useEffect(()=>{const x=async()=>{try{const c=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${t}&longitude=${i}&daily=weather_code,temperature_2m_max,temperature_2m_min&timezone=Europe/Berlin`)).json();if(c.daily){const C=c.daily.time.slice(0,7).map((_,$)=>({date:_,dayName:le(_,$,r.language),weatherCode:c.daily.weather_code[$],tempMax:Math.round(c.daily.temperature_2m_max[$]),tempMin:Math.round(c.daily.temperature_2m_min[$]),icon:de(c.daily.weather_code[$])}));h(C)}}catch(v){console.error("Failed to fetch weather forecast:",v)}finally{a(!1)}};x();const N=setInterval(x,1800*1e3);return()=>clearInterval(N)},[t,i,r.language]),g?e.jsx("div",{className:"weather-forecast-container",children:e.jsx("div",{className:"flex items-center justify-center py-8 text-gray-400",children:e.jsx("i",{className:"fas fa-spinner fa-spin text-2xl text-[#088d95]"})})}):n.length===0?null:e.jsxs("div",{style:{background:"rgba(132, 192, 137, 0.43)",backdropFilter:"blur(20px)",borderRadius:"12px",border:"1px solid black",padding:"20px 24px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)",margin:"0 16px 16px 16px"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"8px",textAlign:"center"},children:n.map(x=>e.jsxs("div",{style:{minWidth:"70px"},children:[e.jsx("div",{style:{fontSize:"11px",fontWeight:"500",color:"#000000ff",textTransform:"uppercase",letterSpacing:"0.5px",marginBottom:"8px"},children:x.dayName}),e.jsx("div",{style:{fontSize:"48px",marginBottom:"8px",height:"36px",display:"flex",alignItems:"center",justifyContent:"center"},children:x.icon}),e.jsxs("div",{style:{fontSize:"16px",fontWeight:"600",color:"#333"},children:[x.tempMax,"¬∞C"]})]},x.date))}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center",marginTop:"12px",fontSize:"10px",color:"#999"}})]})}function le(t,i,o){if(i===0)return o==="de"?"HEUTE":"TODAY";if(i===1)return o==="de"?"MORGEN":"TOMORROW";const r=new Date(t);return o==="de"?["SONNTAG","MONTAG","DIENSTAG","MITTWOCH","DONNERSTAG","FREITAG","SAMSTAG"][r.getDay()]:["SUNDAY","MONDAY","TUESDAY","WEDNESDAY","THURSDAY","FRIDAY","SATURDAY"][r.getDay()]}function de(t){return t===0?"‚òÄÔ∏è":t<=3?"‚õÖ":t<=48?"üå´Ô∏è":t<=55||t<=65?"üåßÔ∏è":t<=75?"‚ùÑÔ∏è":t<=82?"üåßÔ∏è":t<=96?"‚õàÔ∏è":"‚òÅÔ∏è"}export{ge as G,fe as M,xe as P,pe as R,ye as W};
